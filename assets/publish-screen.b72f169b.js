import{b as B,c as F,r as A,t as T,h as $,v as k}from"./App.341e2996.js";import{a4 as D,a8 as I,ab as a,a2 as U,a$ as V,a7 as n,aF as P,aA as g,a3 as u,a5 as M,b0 as i,aY as r,ae as C,b1 as b,n as S,bb as j,bc as N}from"./vendor.1e2d2fe8.js";const z={},q={t:"1640067016334",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4028",width:"64",height:"64"},L=a("path",{d:"M897.00000031 92H126.99999969A34.99999969 34.99999969 0 0 0 92 126.99999969V711.99999969a34.99999969 34.99999969 0 0 0 34.99999969 35.00000062h350.00000062v114.99999938h-194.80000031a34.99999969 34.99999969 0 1 0 0 70.00000031h460.00000031a34.99999969 34.99999969 0 1 0 0-70.00000031h-195.20000062v-114.79999969h350.00000062A34.99999969 34.99999969 0 0 0 932 711.99999969V126.99999969A34.99999969 34.99999969 0 0 0 897.00000031 92zM861.99999969 677.19999969h-699.99999938V162.00000031h699.99999938z","p-id":"4029"},null,-1),H=a("path",{d:"M315.2 519.00000031a34.2 34.2 0 0 0 21.19999969-7.00000031l106.40000062-81.6L531.99999969 505.20000031a34.99999969 34.99999969 0 0 0 44.4 0l155.00000062-123.20000062a34.99999969 34.99999969 0 0 0-43.60000031-54.79999969l-132.40000031 105.40000031-87.99999938-74.80000031a34.99999969 34.99999969 0 0 0-44.00000062-1.00000031l-128.79999938 98.80000031a34.99999969 34.99999969 0 0 0 21.39999938 62.80000031z","p-id":"4030"},null,-1),O=[L,H];function Y(s,o){return D(),I("svg",q,O)}var r9=B(z,[["render",Y]]);const G=U({name:"PublishScreen",props:{projectId:{type:Number,required:!0},modelValue:{type:Boolean,required:!0}},emits:[F],setup(s,o){const d=V(),p=n(!1),l=n(!1),E=n(!1),c=n(""),w=n("password"),t=n(!0),h=P(()=>l.value?A(s.projectId):""),_=()=>{l.value&&S(()=>{$(h.value)&&d.success("\u590D\u5236\u6210\u529F")})},v=()=>{p.value=!1,o.emit(F,!1)};return g(()=>s.modelValue,e=>{e?p.value=!0:p.value=!1}),g(()=>s.projectId,async()=>{try{const e=await T(s.projectId);if(e.data.code===0){const{data:f}=e.data;t.value=!1,l.value=!!f.share,c.value=f.password}}catch{d.error("\u8BFB\u53D6\u5927\u5C4F\u53D1\u5E03\u4FE1\u606F\u5931\u8D25")}}),{visible:p,isPublish:l,shareUrl:h,showTooltip:E,password:c,copyUrl:_,closeDialog:v,loading:t,passwordType:w,publish:async()=>{try{t.value=!0;const e={share:h.value,password:c.value};(await k(s.projectId,e)).data.code===0&&(t.value=!1,v(),d.success(l.value?"\u53D1\u5E03\u6210\u529F":"\u4FDD\u5B58\u6210\u529F"))}catch{d.error("\u53D1\u5E03\u5931\u8D25")}finally{t.value=!1}}}}}),m=s=>(j("data-v-71cc8724"),s=s(),N(),s),J={class:"share-header"},K={class:"header-wp"},Q=m(()=>a("label",{class:"label-color"},"\u53D1\u5E03\u5206\u4EAB\uFF1A",-1)),R={class:"share-switch"},W={class:"share-tutorial"},X=b(" \u67E5\u770B\u6559\u7A0B "),Z={class:"share-verify"},x=m(()=>a("div",{class:"label-color"},"\u5206\u4EAB\u94FE\u63A5",-1)),s9={class:"link-content"},e9=["value"],o9=b(" \u70B9\u51FB\u590D\u5236 "),a9=m(()=>a("div",{class:"label-color"},"\u8BBF\u95EE\u5BC6\u7801",-1)),t9={class:"share-pwd"},u9={class:"initial-dialog"};function l9(s,o,d,p,l,E){const c=u("n-switch"),w=u("router-link"),t=u("n-tooltip"),h=u("new-input"),_=u("n-button"),v=u("n-spin"),y=u("n-modal");return D(),M(y,{show:s.visible,"onUpdate:show":o[8]||(o[8]=e=>s.visible=e),preset:"dialog","show-icon":!1,title:"\u53D1\u5E03",style:{width:"435px"},onClose:s.closeDialog},{default:i(()=>[r(v,{show:s.loading,class:"share-setting"},{default:i(()=>[a("div",J,[a("div",K,[Q,a("div",R,[r(c,{value:s.isPublish,"onUpdate:value":o[0]||(o[0]=e=>s.isPublish=e)},null,8,["value"])])]),a("div",W,[r(w,{to:{name:"MyCase"},class:"share-tutorial-url",target:"_blank"},{default:i(()=>[X]),_:1})])]),a("div",Z,[x,a("div",s9,[r(t,{show:s.showTooltip,trigger:"manual",disabled:!s.isPublish},{trigger:i(()=>[a("textarea",{value:s.shareUrl,class:"new-input share-input",readonly:"",placeholder:"\u5F00\u542F\u53D1\u5E03\u5206\u4EAB\u540E\u53EF\u83B7\u53D6\u8BBF\u95EE\u94FE\u63A5",onClick:o[1]||(o[1]=(...e)=>s.copyUrl&&s.copyUrl(...e)),onMouseenter:o[2]||(o[2]=e=>s.showTooltip=!0),onMouseleave:o[3]||(o[3]=e=>s.showTooltip=!1)},null,40,e9)]),default:i(()=>[o9]),_:1},8,["show","disabled"]),a("div",{class:"func-btn",onClick:o[4]||(o[4]=(...e)=>s.copyUrl&&s.copyUrl(...e))},"\u590D\u5236")]),a9,a("div",t9,[r(h,{modelValue:s.password,"onUpdate:modelValue":o[5]||(o[5]=e=>s.password=e),type:s.passwordType,placeholder:"\u8BBE\u7F6E\u8BBF\u95EE\u5BC6\u7801",class:"pwd-input"},null,8,["modelValue","type"]),a("div",{class:"func-btn",onClick:o[6]||(o[6]=e=>s.passwordType?s.passwordType="":s.passwordType="password")},C(s.passwordType?"\u67E5\u770B":"\u9690\u85CF"),1),a("div",{class:"func-btn",onClick:o[7]||(o[7]=e=>s.password="")}," \u6E05\u7A7A ")])]),a("div",u9,[r(_,{type:"primary",focusable:!1,class:"publish-btn",onClick:s.publish},{default:i(()=>[b(C(s.isPublish?"\u53D1\u5E03\u5927\u5C4F":"\u4FDD\u5B58"),1)]),_:1},8,["onClick"])])]),_:1},8,["show"])]),_:1},8,["show","onClose"])}var d9=B(G,[["render",l9],["__scopeId","data-v-71cc8724"]]);export{r9 as I,d9 as P};
